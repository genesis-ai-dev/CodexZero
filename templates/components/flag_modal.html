{% macro flag_modal() %}
<div id="flag-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
    <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] flex flex-col border border-neutral-200">
            <div class="flex items-center justify-between p-6 border-b border-neutral-200">
                <h3 class="text-xl font-bold text-neutral-900 tracking-tight">Verse Flags</h3>
                <button onclick="closeFlagModal()" class="text-neutral-400 hover:text-neutral-600 p-2 rounded-lg hover:bg-neutral-100 transition-all duration-200">
                    <i class="fas fa-times text-lg"></i>
                </button>
            </div>
            
            <div class="p-6 bg-blue-50 border-b border-blue-200">
                <div class="text-sm font-medium text-blue-900 mb-2">Current Verse:</div>
                <div id="flag-verse-reference" class="text-blue-900 font-semibold text-lg"></div>
            </div>
            
            <div class="flex-1 overflow-y-auto">
                <div id="flags-list" class="p-6 space-y-4">
                </div>
            </div>
            
            <div class="border-t border-neutral-200 p-6 bg-neutral-50">
                <button onclick="showNewThreadForm()" class="w-full px-6 py-3 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-xl hover:from-green-700 hover:to-green-800 transition-all duration-200 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105">
                    <i class="fas fa-plus mr-2"></i>Start New Thread
                </button>
            </div>
        </div>
    </div>
</div>


<div id="flag-details-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
    <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] flex flex-col border border-neutral-200">
            <div class="flex items-center justify-between p-6 border-b border-neutral-200">
                <div class="flex items-center space-x-4">
                    <h3 class="text-xl font-bold text-neutral-900 tracking-tight">Thread</h3>
                    <span id="flag-details-status" class="px-3 py-1 rounded-full text-sm font-medium"></span>
                </div>
                <div class="flex items-center space-x-2">
                    <button id="flag-status-toggle" onclick="toggleFlagStatus()" class="px-4 py-2 text-sm border border-neutral-300 rounded-lg hover:bg-neutral-50 transition-all duration-200 font-medium">
                    </button>
                    <button onclick="closeFlagDetailsModal()" class="text-neutral-400 hover:text-neutral-600 p-2 rounded-lg hover:bg-neutral-100 transition-all duration-200">
                        <i class="fas fa-times text-lg"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6 bg-blue-50 border-b border-blue-200">
                <div class="text-sm font-medium text-blue-900 mb-2">Associated Verses:</div>
                <div id="flag-details-verses" class="text-blue-900 font-semibold"></div>
            </div>
            
            <div class="flex-1 overflow-y-auto p-6">
                <div id="flag-comments" class="space-y-4">
                </div>
            </div>
            
            <div class="border-t border-neutral-200 p-6 bg-neutral-50">
                <div class="flex space-x-3">
                    <textarea id="new-comment-text" rows="2" class="flex-1 border border-neutral-300 rounded-xl px-4 py-3 text-sm bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 resize-none" placeholder="Add a comment... Use @ to mention team members." maxlength="5000"></textarea>
                    <button onclick="addComment()" class="px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-200 font-semibold shadow-lg hover:shadow-xl">
                        <i class="fas fa-paper-plane mr-2"></i>Post
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="mention-dropdown" class="fixed bg-white border border-neutral-200 rounded-lg shadow-lg max-h-40 overflow-y-auto hidden z-50">
</div>
{% endmacro %} 